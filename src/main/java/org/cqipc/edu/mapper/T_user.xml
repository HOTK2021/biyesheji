<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.cqipc.edu.dao.T_userDao">
	<select id="userLogin" resultType="T_user">
		select * from t_user where username=#{username} and password=#{password}
	</select>
	<select id="selectUserAll" resultType="T_user">
		select u.user_id as"user_id",u.username as"username",d.totalage as"totalage"
		from t_user u,t_mingjie_lifeanddie d where u.USER_ID=d.userId

		limit #{pageCount},#{pageSize}
	</select>
	
	<select id="selectUserCount" resultType="int">
		select count(*) from t_user
		<if test="user_id!=0">
			where user_id=#{user_id}
		</if>
		<if test='username!="" or username!=null'>
			where username  like concat('%',#{username},'%')
		</if>
	</select>

	<select id="selectUserDieAll" resultType="T_user">
		select * from t_user_c
		<if test="user_id!=0">
			<where>
				and user_id=#{user_id}
			</where>
		</if>
		<if test='username!="" and username!=null'>
			<where>
				and username like concat('%',#{username},'%')
			</where>
		</if>
		limit #{pageCount},#{pageSize}
	</select>
	<select id="selectUserDieCount" resultType="int">
		select count(*) from t_user_c
		<if test="user_id!=0">
			<where>
				and user_id=#{user_id}
			</where>

		</if>
		<if test='username!="" and username!=null'>
			<where>
				and username like concat('%',#{username},'%')
			</where>

		</if>
	</select>
	<insert id="adduser" >
		insert into t_user values(null,#{username},#{password},#{dept_id},#{email},#{mobile},#{status},
		#{create_time},#{modify_time},#{last_login_time},#{ssex},#{description},#{avatar},#{age}
		)
	</insert>
	<select id="selectUserDie" resultType="T_user">
		select * from t_user_c where status = 1 and user_id=(select user_id from t_plife where user_c_id is null);
	</select>

</mapper>